
<!DOCTYPE html>
<html>
<head>
    <title>Codenames Online</title>
    <style>
        body { font-family: Arial; text-align: center; padding: 20px; }
        #board { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; max-width: 600px; margin: 20px auto; }
        .card {
            border: 2px solid #333; border-radius: 8px; padding: 20px;
            background: #f8f9fa; cursor: pointer; font-weight: bold; user-select: none;
        }
        .card.revealed.red { background: #ff6b6b; color: white; }
        .card.revealed.blue { background: #4d96ff; color: white; }
        .card.revealed.black { background: #2d3436; color: white; }
        .card.revealed.neutral { background: #fdcb6e; }
        #status { margin: 20px; font-size: 1.2em; }
    </style>
</head>
<body>
    <h1>ðŸŽ® Codenames Online</h1>
    <div id="roomInfo">ÐšÐ¾Ð¼Ð½Ð°Ñ‚Ð°: <span id="roomId">...</span></div>
    <div id="status">ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ðº Ð¸Ð³Ñ€Ðµ...</div>
    <div id="board"></div>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const roomId = urlParams.get('room') || prompt('Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ID ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹:');
        document.getElementById('roomId').textContent = roomId;
        let ws;
        function connect() {
            // ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ÑÑ Ðº WebSocket-ÑÐµÑ€Ð²ÐµÑ€Ñƒ Ð½Ð° Render
            const wsUrl = `wss://codenames-u88n.onrender.com/ws?room=${roomId}`;
            ws = new WebSocket(wsUrl);
            ws.onopen = () => document.getElementById('status').textContent = 'âœ… Ð˜Ð³Ñ€Ð° Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð°!';
            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                if (data.type === 'state_update') updateBoard(data.game);
                if (data.type === 'card_revealed') revealCard(data.index, data.color);
                if (data.type === 'game_over') alert(`ÐŸÐ¾Ð±ÐµÐ´Ð¸Ð»Ð¸ ${data.winner}! (${data.reason})`);
            };
            ws.onclose = () => {
                document.getElementById('status').textContent = 'âŒ Ð¡Ð¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ñ‚ÐµÑ€ÑÐ½Ð¾. ÐŸÐµÑ€ÐµÐ¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ...';
                setTimeout(connect, 3000);
            };
        }
        function updateBoard(game) {
            const board = document.getElementById('board');
            board.innerHTML = '';
            game.words.forEach((word, i) => {
                const card = document.createElement('div');
                card.className = 'card' + (game.revealed[i] ? ` revealed ${game.key[i]}` : '');
                card.textContent = word;
                card.onclick = () => {
                    if (!game.revealed[i] && ws.readyState === WebSocket.OPEN) {
                        ws.send(JSON.stringify({ action: 'reveal', index: i }));
                    }
                };
                board.appendChild(card);
            });
        }
        function revealCard(index, color) {
            const cards = document.getElementsByClassName('card');
            cards[index].classList.add('revealed', color);
        }
        connect();
    </script>
</body>
</html>